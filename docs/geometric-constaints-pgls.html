<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Section 7 Geometric constaints PGLS | Source code for High elevation Himalayan birds shift elevations to track thermal regimes across seasons</title>
  <meta name="description" content="Section 7 Geometric constaints PGLS | Source code for High elevation Himalayan birds shift elevations to track thermal regimes across seasons" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Section 7 Geometric constaints PGLS | Source code for High elevation Himalayan birds shift elevations to track thermal regimes across seasons" />
  <meta property="og:type" content="book" />
  
  
  
  <meta name="github-repo" content="vjjan91/elevMigration" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Section 7 Geometric constaints PGLS | Source code for High elevation Himalayan birds shift elevations to track thermal regimes across seasons" />
  
  
  

<meta name="author" content="Sahas Barve" />
<meta name="author" content="Tarun Menon" />
<meta name="author" content="Vijay Ramesh" />


<meta name="date" content="2022-05-13" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="extent-of-elevational-migration.html"/>
<link rel="next" href="phylogenetic-generalized-least-squares-regressions.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#data-processing"><i class="fa fa-check"></i><b>1.1</b> Data processing</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#attribution"><i class="fa fa-check"></i><b>1.2</b> Attribution</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#data-access"><i class="fa fa-check"></i><b>1.3</b> Data access</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#the-data-used-in-this-work-is-archived-on-zenodo."><i class="fa fa-check"></i><b>1.4</b> The data used in this work is archived on Zenodo.</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="spatial-thinning-of-occurrence-data.html"><a href="spatial-thinning-of-occurrence-data.html"><i class="fa fa-check"></i><b>2</b> Spatial thinning of occurrence data</a><ul>
<li class="chapter" data-level="2.1" data-path="spatial-thinning-of-occurrence-data.html"><a href="spatial-thinning-of-occurrence-data.html#load-necessary-libraries"><i class="fa fa-check"></i><b>2.1</b> Load necessary libraries</a></li>
<li class="chapter" data-level="2.2" data-path="spatial-thinning-of-occurrence-data.html"><a href="spatial-thinning-of-occurrence-data.html#load-data"><i class="fa fa-check"></i><b>2.2</b> Load data</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="temperature-elevation-associations.html"><a href="temperature-elevation-associations.html"><i class="fa fa-check"></i><b>3</b> Temperature-elevation associations</a><ul>
<li class="chapter" data-level="3.1" data-path="temperature-elevation-associations.html"><a href="temperature-elevation-associations.html#load-necessary-libraries-1"><i class="fa fa-check"></i><b>3.1</b> Load necessary libraries</a></li>
<li class="chapter" data-level="3.2" data-path="temperature-elevation-associations.html"><a href="temperature-elevation-associations.html#load-shapefiles"><i class="fa fa-check"></i><b>3.2</b> Load shapefiles</a></li>
<li class="chapter" data-level="3.3" data-path="temperature-elevation-associations.html"><a href="temperature-elevation-associations.html#prepare-elevation-rasters"><i class="fa fa-check"></i><b>3.3</b> Prepare elevation rasters</a></li>
<li class="chapter" data-level="3.4" data-path="temperature-elevation-associations.html"><a href="temperature-elevation-associations.html#prepare-climate-rasters"><i class="fa fa-check"></i><b>3.4</b> Prepare climate rasters</a></li>
<li class="chapter" data-level="3.5" data-path="temperature-elevation-associations.html"><a href="temperature-elevation-associations.html#extracting-data-across-elevational-bands"><i class="fa fa-check"></i><b>3.5</b> Extracting data across elevational bands</a></li>
<li class="chapter" data-level="3.6" data-path="temperature-elevation-associations.html"><a href="temperature-elevation-associations.html#plot-temperature-as-a-function-of-elevation"><i class="fa fa-check"></i><b>3.6</b> Plot temperature as a function of elevation</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="processing-ebird-data.html"><a href="processing-ebird-data.html"><i class="fa fa-check"></i><b>4</b> Processing eBird data</a><ul>
<li class="chapter" data-level="4.1" data-path="processing-ebird-data.html"><a href="processing-ebird-data.html#load-necessary-libraries-2"><i class="fa fa-check"></i><b>4.1</b> Load necessary libraries</a></li>
<li class="chapter" data-level="4.2" data-path="processing-ebird-data.html"><a href="processing-ebird-data.html#loading-custom-functions-to-process-ebird-data"><i class="fa fa-check"></i><b>4.2</b> Loading custom functions to process eBird data</a></li>
<li class="chapter" data-level="4.3" data-path="processing-ebird-data.html"><a href="processing-ebird-data.html#use-the-function-written-above-to-extract-ebird-data"><i class="fa fa-check"></i><b>4.3</b> Use the function written above to extract eBird data</a></li>
<li class="chapter" data-level="4.4" data-path="processing-ebird-data.html"><a href="processing-ebird-data.html#extract-elevation-at-unique-locations"><i class="fa fa-check"></i><b>4.4</b> Extract elevation at unique locations</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="resampling-analysis.html"><a href="resampling-analysis.html"><i class="fa fa-check"></i><b>5</b> Resampling analysis</a><ul>
<li class="chapter" data-level="5.1" data-path="resampling-analysis.html"><a href="resampling-analysis.html#load-.rdata-file-containing-elevation-data-across-ebird-sampling-locations"><i class="fa fa-check"></i><b>5.1</b> Load .Rdata file containing elevation data across eBird sampling locations</a></li>
<li class="chapter" data-level="5.2" data-path="resampling-analysis.html"><a href="resampling-analysis.html#create-resampled-datasets"><i class="fa fa-check"></i><b>5.2</b> Create resampled datasets</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="extent-of-elevational-migration.html"><a href="extent-of-elevational-migration.html"><i class="fa fa-check"></i><b>6</b> Extent of elevational migration</a><ul>
<li class="chapter" data-level="6.1" data-path="extent-of-elevational-migration.html"><a href="extent-of-elevational-migration.html#load-necessary-libraries-3"><i class="fa fa-check"></i><b>6.1</b> Load necessary libraries</a></li>
<li class="chapter" data-level="6.2" data-path="extent-of-elevational-migration.html"><a href="extent-of-elevational-migration.html#eastern-himalayas"><i class="fa fa-check"></i><b>6.2</b> Eastern Himalayas</a></li>
<li class="chapter" data-level="6.3" data-path="extent-of-elevational-migration.html"><a href="extent-of-elevational-migration.html#western-himalayas"><i class="fa fa-check"></i><b>6.3</b> Western Himalayas</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="geometric-constaints-pgls.html"><a href="geometric-constaints-pgls.html"><i class="fa fa-check"></i><b>7</b> Geometric constaints PGLS</a></li>
<li class="chapter" data-level="8" data-path="phylogenetic-generalized-least-squares-regressions.html"><a href="phylogenetic-generalized-least-squares-regressions.html"><i class="fa fa-check"></i><b>8</b> Phylogenetic generalized least squares regressions</a><ul>
<li class="chapter" data-level="8.1" data-path="phylogenetic-generalized-least-squares-regressions.html"><a href="phylogenetic-generalized-least-squares-regressions.html#remove-non-himalayan-species"><i class="fa fa-check"></i><b>8.1</b> Remove non-Himalayan species</a></li>
<li class="chapter" data-level="8.2" data-path="phylogenetic-generalized-least-squares-regressions.html"><a href="phylogenetic-generalized-least-squares-regressions.html#pgls-models-for-the-eastern-himalayas"><i class="fa fa-check"></i><b>8.2</b> PGLS models for the Eastern Himalayas</a></li>
<li class="chapter" data-level="8.3" data-path="phylogenetic-generalized-least-squares-regressions.html"><a href="phylogenetic-generalized-least-squares-regressions.html#pgls-models-for-the-western-himalayas"><i class="fa fa-check"></i><b>8.3</b> PGLS models for the Western Himalayas</a></li>
<li class="chapter" data-level="8.4" data-path="phylogenetic-generalized-least-squares-regressions.html"><a href="phylogenetic-generalized-least-squares-regressions.html#phylogenetic-paired-t-test"><i class="fa fa-check"></i><b>8.4</b> Phylogenetic paired t-test</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Source code for <em>High elevation Himalayan birds shift elevations to track thermal regimes across seasons</em></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="geometric-constaints-pgls" class="section level1">
<h1><span class="header-section-number">Section 7</span> Geometric constaints PGLS</h1>
<p>In this script, we tested for an association between absolute elevational shift (to retain both upslope and downslope shifts) and the breadth of elevational distribution (elevational range) of the species, in which we calculated elevational range by subtracting the summer lower elevation limit from the summer upper elevational limit. To test whether elevational shifts are greater for high or low elevation birds simply because they have more elevation to potentially shift (upslope or downslope), we calculated absolute relative elevational shift as the elevational shift at each elevational limit (upper, median, lower) divided by the predicted elevation for the respective limit (i.e.i.e., elevational shift at upper limit / elevational upper limit).</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb18-1"><a href="geometric-constaints-pgls.html#cb18-1"></a>tree &lt;-<span class="st"> </span><span class="kw">read.nexus</span>(<span class="st">&quot;data/birdtree.nex&quot;</span>)</span>
<span id="cb18-2"><a href="geometric-constaints-pgls.html#cb18-2"></a>tree &lt;-<span class="st"> </span><span class="kw">mcc</span>(tree) <span class="co">## maximum clade credibility tree</span></span>
<span id="cb18-3"><a href="geometric-constaints-pgls.html#cb18-3"></a>x &lt;-<span class="st"> </span>East_ele_range_higheffort </span>
<span id="cb18-4"><a href="geometric-constaints-pgls.html#cb18-4"></a><span class="co">### repeat for East_ele_range_mediumeffort, East_ele_range_loweffort, West_ele_range_mediumeffort, West_ele_range_higheffort,West_ele_range_loweffort</span></span>
<span id="cb18-5"><a href="geometric-constaints-pgls.html#cb18-5"></a></span>
<span id="cb18-6"><a href="geometric-constaints-pgls.html#cb18-6"></a>x<span class="op">$</span>absrelshift_upper&lt;-<span class="kw">abs</span>(x<span class="op">$</span>Diff_ratio_upper)</span>
<span id="cb18-7"><a href="geometric-constaints-pgls.html#cb18-7"></a>x<span class="op">$</span>absrelshift_median&lt;-<span class="kw">abs</span>(x<span class="op">$</span>Diff_ratio_median)</span>
<span id="cb18-8"><a href="geometric-constaints-pgls.html#cb18-8"></a>x<span class="op">$</span>absrelshift_lower&lt;-<span class="kw">abs</span>(x<span class="op">$</span>Diff_ratio_lower)</span>
<span id="cb18-9"><a href="geometric-constaints-pgls.html#cb18-9"></a></span>
<span id="cb18-10"><a href="geometric-constaints-pgls.html#cb18-10"></a>pruned.tree &lt;-<span class="kw">drop.tip</span>(tree,tree<span class="op">$</span>tip.label[<span class="op">-</span><span class="kw">match</span>(x<span class="op">$</span>Tree.name, tree<span class="op">$</span>tip.label)])</span>
<span id="cb18-11"><a href="geometric-constaints-pgls.html#cb18-11"></a>pruned.tree</span>
<span id="cb18-12"><a href="geometric-constaints-pgls.html#cb18-12"></a>glsdata&lt;-x[<span class="kw">match</span>(pruned.tree<span class="op">$</span>tip.label, x<span class="op">$</span>Tree.name),]</span>
<span id="cb18-13"><a href="geometric-constaints-pgls.html#cb18-13"></a>pgls1&lt;-<span class="kw">gls</span>(absrelshift_upper<span class="op">~</span>Summer_range,<span class="dt">correlation=</span><span class="kw">corPagel</span>(<span class="dv">1</span>,pruned.tree),<span class="dt">data=</span>glsdata)</span>
<span id="cb18-14"><a href="geometric-constaints-pgls.html#cb18-14"></a>j&lt;-<span class="kw">summary</span>(pgls1)</span>
<span id="cb18-15"><a href="geometric-constaints-pgls.html#cb18-15"></a>j</span>
<span id="cb18-16"><a href="geometric-constaints-pgls.html#cb18-16"></a>pgls3&lt;-<span class="kw">gls</span>(absrelshift_median<span class="op">~</span>Summer_range,<span class="dt">correlation=</span><span class="kw">corPagel</span>(<span class="dv">1</span>,pruned.tree),<span class="dt">data=</span>glsdata)</span>
<span id="cb18-17"><a href="geometric-constaints-pgls.html#cb18-17"></a>k&lt;-<span class="kw">summary</span>(pgls3)</span>
<span id="cb18-18"><a href="geometric-constaints-pgls.html#cb18-18"></a>k</span>
<span id="cb18-19"><a href="geometric-constaints-pgls.html#cb18-19"></a>pgls4&lt;-<span class="kw">gls</span>(absrelshift_lower<span class="op">~</span>Summer_range,<span class="dt">correlation=</span><span class="kw">corPagel</span>(<span class="dv">1</span>,pruned.tree),<span class="dt">data=</span>glsdata)</span>
<span id="cb18-20"><a href="geometric-constaints-pgls.html#cb18-20"></a>l&lt;-<span class="kw">summary</span>(pgls4)</span>
<span id="cb18-21"><a href="geometric-constaints-pgls.html#cb18-21"></a>l</span>
<span id="cb18-22"><a href="geometric-constaints-pgls.html#cb18-22"></a>outputj&lt;-<span class="kw">as.data.frame</span>(j<span class="op">$</span>tTable)</span>
<span id="cb18-23"><a href="geometric-constaints-pgls.html#cb18-23"></a>outputj<span class="op">$</span>Lambda&lt;-j<span class="op">$</span>modelStruct</span>
<span id="cb18-24"><a href="geometric-constaints-pgls.html#cb18-24"></a>outputj&lt;-<span class="kw">as.matrix</span>(outputj)</span>
<span id="cb18-25"><a href="geometric-constaints-pgls.html#cb18-25"></a></span>
<span id="cb18-26"><a href="geometric-constaints-pgls.html#cb18-26"></a>outputk&lt;-<span class="kw">as.data.frame</span>(k<span class="op">$</span>tTable)</span>
<span id="cb18-27"><a href="geometric-constaints-pgls.html#cb18-27"></a>outputk<span class="op">$</span>Lambda&lt;-k<span class="op">$</span>modelStruct</span>
<span id="cb18-28"><a href="geometric-constaints-pgls.html#cb18-28"></a>outputk&lt;-<span class="kw">as.matrix</span>(outputk)</span>
<span id="cb18-29"><a href="geometric-constaints-pgls.html#cb18-29"></a>outputl&lt;-<span class="kw">as.data.frame</span>(l<span class="op">$</span>tTable)</span>
<span id="cb18-30"><a href="geometric-constaints-pgls.html#cb18-30"></a>outputl<span class="op">$</span>Lambda&lt;-l<span class="op">$</span>modelStruct</span>
<span id="cb18-31"><a href="geometric-constaints-pgls.html#cb18-31"></a>outputl&lt;-<span class="kw">as.matrix</span>(outputl)</span>
<span id="cb18-32"><a href="geometric-constaints-pgls.html#cb18-32"></a><span class="kw">write.csv</span>(outputj,<span class="dt">file=</span><span class="st">&quot;East_absrelshift_upper~Summer_range_higheffort.csv&quot;</span>,<span class="dt">row.names=</span><span class="ot">FALSE</span>)</span>
<span id="cb18-33"><a href="geometric-constaints-pgls.html#cb18-33"></a><span class="kw">write.csv</span>(outputk,<span class="dt">file=</span><span class="st">&quot;East_absrelshift_median~Summer_range_higheffort.csv&quot;</span>,<span class="dt">row.names=</span><span class="ot">FALSE</span>)</span>
<span id="cb18-34"><a href="geometric-constaints-pgls.html#cb18-34"></a><span class="kw">write.csv</span>(outputl,<span class="dt">file=</span><span class="st">&quot;East_absrelshift_lower~Summer_range_higheffort.csv.csv&quot;</span>,<span class="dt">row.names=</span><span class="ot">FALSE</span>)</span>
<span id="cb18-35"><a href="geometric-constaints-pgls.html#cb18-35"></a></span>
<span id="cb18-36"><a href="geometric-constaints-pgls.html#cb18-36"></a><span class="co">## Absolute shift ~ Summer Elevational</span></span>
<span id="cb18-37"><a href="geometric-constaints-pgls.html#cb18-37"></a></span>
<span id="cb18-38"><a href="geometric-constaints-pgls.html#cb18-38"></a>x&lt;-East_ele_range_higheffort</span>
<span id="cb18-39"><a href="geometric-constaints-pgls.html#cb18-39"></a></span>
<span id="cb18-40"><a href="geometric-constaints-pgls.html#cb18-40"></a><span class="co">### repeat for East_ele_range_mediumeffort, East_ele_range_loweffort, West_ele_range_mediumeffort, West_ele_range_higheffort,West_ele_range_loweffort</span></span>
<span id="cb18-41"><a href="geometric-constaints-pgls.html#cb18-41"></a></span>
<span id="cb18-42"><a href="geometric-constaints-pgls.html#cb18-42"></a>x<span class="op">$</span>absrelshift_upper&lt;-<span class="kw">abs</span>(x<span class="op">$</span>Diff_ratio_upper)</span>
<span id="cb18-43"><a href="geometric-constaints-pgls.html#cb18-43"></a>x<span class="op">$</span>absrelshift_median&lt;-<span class="kw">abs</span>(x<span class="op">$</span>Diff_ratio_median)</span>
<span id="cb18-44"><a href="geometric-constaints-pgls.html#cb18-44"></a>x<span class="op">$</span>absrelshift_lower&lt;-<span class="kw">abs</span>(x<span class="op">$</span>Diff_ratio_lower)</span>
<span id="cb18-45"><a href="geometric-constaints-pgls.html#cb18-45"></a></span>
<span id="cb18-46"><a href="geometric-constaints-pgls.html#cb18-46"></a>pruned.tree&lt;-<span class="kw">drop.tip</span>(tree1,tree1<span class="op">$</span>tip.label[<span class="op">-</span><span class="kw">match</span>(x<span class="op">$</span>Tree.name, tree1<span class="op">$</span>tip.label)])</span>
<span id="cb18-47"><a href="geometric-constaints-pgls.html#cb18-47"></a>pruned.tree</span>
<span id="cb18-48"><a href="geometric-constaints-pgls.html#cb18-48"></a>glsdata&lt;-x[<span class="kw">match</span>(pruned.tree<span class="op">$</span>tip.label, x<span class="op">$</span>Tree.name),]</span>
<span id="cb18-49"><a href="geometric-constaints-pgls.html#cb18-49"></a>pgls1&lt;-<span class="kw">gls</span>(absrelshift_upper<span class="op">~</span>Median_S_upper,<span class="dt">correlation=</span><span class="kw">corPagel</span>(<span class="dv">1</span>,pruned.tree),<span class="dt">data=</span>glsdata)</span>
<span id="cb18-50"><a href="geometric-constaints-pgls.html#cb18-50"></a>j&lt;-<span class="kw">summary</span>(pgls1)</span>
<span id="cb18-51"><a href="geometric-constaints-pgls.html#cb18-51"></a>j</span>
<span id="cb18-52"><a href="geometric-constaints-pgls.html#cb18-52"></a>pgls3&lt;-<span class="kw">gls</span>(absrelshift_median<span class="op">~</span>Median_S_median,<span class="dt">correlation=</span><span class="kw">corPagel</span>(<span class="dv">1</span>,pruned.tree),<span class="dt">data=</span>glsdata)</span>
<span id="cb18-53"><a href="geometric-constaints-pgls.html#cb18-53"></a>k&lt;-<span class="kw">summary</span>(pgls3)</span>
<span id="cb18-54"><a href="geometric-constaints-pgls.html#cb18-54"></a>k</span>
<span id="cb18-55"><a href="geometric-constaints-pgls.html#cb18-55"></a>pgls4&lt;-<span class="kw">gls</span>(absrelshift_lower<span class="op">~</span>Median_S_lower,<span class="dt">correlation=</span><span class="kw">corPagel</span>(<span class="dv">1</span>,pruned.tree),<span class="dt">data=</span>glsdata)</span>
<span id="cb18-56"><a href="geometric-constaints-pgls.html#cb18-56"></a>l&lt;-<span class="kw">summary</span>(pgls4)</span>
<span id="cb18-57"><a href="geometric-constaints-pgls.html#cb18-57"></a>l</span>
<span id="cb18-58"><a href="geometric-constaints-pgls.html#cb18-58"></a>outputj&lt;-<span class="kw">as.data.frame</span>(j<span class="op">$</span>tTable)</span>
<span id="cb18-59"><a href="geometric-constaints-pgls.html#cb18-59"></a>outputj<span class="op">$</span>Lambda&lt;-j<span class="op">$</span>modelStruct</span>
<span id="cb18-60"><a href="geometric-constaints-pgls.html#cb18-60"></a>outputj&lt;-<span class="kw">as.matrix</span>(outputj)</span>
<span id="cb18-61"><a href="geometric-constaints-pgls.html#cb18-61"></a></span>
<span id="cb18-62"><a href="geometric-constaints-pgls.html#cb18-62"></a>outputk&lt;-<span class="kw">as.data.frame</span>(k<span class="op">$</span>tTable)</span>
<span id="cb18-63"><a href="geometric-constaints-pgls.html#cb18-63"></a>outputk<span class="op">$</span>Lambda&lt;-k<span class="op">$</span>modelStruct</span>
<span id="cb18-64"><a href="geometric-constaints-pgls.html#cb18-64"></a>outputk&lt;-<span class="kw">as.matrix</span>(outputk)</span>
<span id="cb18-65"><a href="geometric-constaints-pgls.html#cb18-65"></a>outputl&lt;-<span class="kw">as.data.frame</span>(l<span class="op">$</span>tTable)</span>
<span id="cb18-66"><a href="geometric-constaints-pgls.html#cb18-66"></a>outputl<span class="op">$</span>Lambda&lt;-l<span class="op">$</span>modelStruct</span>
<span id="cb18-67"><a href="geometric-constaints-pgls.html#cb18-67"></a>outputl&lt;-<span class="kw">as.matrix</span>(outputl)</span>
<span id="cb18-68"><a href="geometric-constaints-pgls.html#cb18-68"></a><span class="kw">write.csv</span>(outputj,<span class="dt">file=</span><span class="st">&quot;East_absrelshift_upper~Median_S_upper_higheffort.csv&quot;</span>,<span class="dt">row.names=</span><span class="ot">FALSE</span>)</span>
<span id="cb18-69"><a href="geometric-constaints-pgls.html#cb18-69"></a><span class="kw">write.csv</span>(outputk,<span class="dt">file=</span><span class="st">&quot;East_absrelshift_median~Median_S_median_higheffort.csv&quot;</span>,<span class="dt">row.names=</span><span class="ot">FALSE</span>)</span>
<span id="cb18-70"><a href="geometric-constaints-pgls.html#cb18-70"></a><span class="kw">write.csv</span>(outputl,<span class="dt">file=</span><span class="st">&quot;East_absrelshift_lower~Median_S_lower_higheffort.csv.csv&quot;</span>,<span class="dt">row.names=</span><span class="ot">FALSE</span>)</span></code></pre></div>
<div class="figure">
<img src="figs/fig03.jpg" alt="" />
<p class="caption"><strong>Geometric constraints do not drive elevational shifts.</strong>
Dashed lines represent predicted relationship based on linear regression model. Error bands denote standard errors. Blue lines and dots represent downslope shifts while red lines and dots are birds that shift upslope. Top Panel: Relationship between median shift upslope or downslope and summer elevational range in eastern (3A) and western Himalayas (3B), both statistically significant (Supplementary Table 2). Bottom Panel: Relationship between relative elevational shift and summer elevation (median distribution). The relationship was not significant in the east (3C) but significant in the west (3D).</p>
</div>

</div>
            </section>

          </div>
        </div>
      </div>
<a href="extent-of-elevational-migration.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="phylogenetic-generalized-least-squares-regressions.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/vjjan91/elevMigration/edit/master/06_geometric-constraints.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
